import { createApp } from 'https://unpkg.com/petite-vue?module'

createApp({
    teams: [
        {
            "name": "Anaheim Ducks",
            "shortcut": "ANA",
            "logo": "ANA.png",
            "conference": "W",
            "division": "P",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Utah Hockey Club",
            "shortcut": "UTA",
            "logo": "UTA.png",
            "conference": "W",
            "division": "C",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Boston Bruins",
            "shortcut": "BOS",
            "logo": "BOS.png",
            "conference": "E",
            "division": "A",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Buffalo Sabres",
            "shortcut": "BUF",
            "logo": "BUF.png",
            "conference": "E",
            "division": "A",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Calgary Flames",
            "shortcut": "CGY",
            "logo": "CGY.png",
            "conference": "W",
            "division": "P",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Carolina Hurricanes",
            "shortcut": "CAR",
            "logo": "CAR.png",
            "conference": "E",
            "division": "M",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Chicago Blackhawks",
            "shortcut": "CHI",
            "logo": "CHI.png",
            "conference": "W",
            "division": "C",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Colorado Avalanche",
            "shortcut": "COL",
            "logo": "COL.png",
            "conference": "W",
            "division": "C",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Columbus Blue Jackets",
            "shortcut": "CBJ",
            "logo": "CBJ.png",
            "conference": "E",
            "division": "M",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Dallas Stars",
            "shortcut": "DAL",
            "logo": "DAL.png",
            "conference": "W",
            "division": "C",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Detroit Red Wings",
            "shortcut": "DET",
            "logo": "DET.png",
            "conference": "E",
            "division": "A",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Edmonton Oilers",
            "shortcut": "EDM",
            "logo": "EDM.png",
            "conference": "W",
            "division": "P",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Florida Panthers",
            "shortcut": "FLA",
            "logo": "FLA.png",
            "conference": "E",
            "division": "A",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Los Angeles Kings",
            "shortcut": "LAK",
            "logo": "LAK.png",
            "conference": "W",
            "division": "P",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Minnesota Wild",
            "shortcut": "MIN",
            "logo": "MIN.png",
            "conference": "W",
            "division": "C",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Montreal Canadiens",
            "shortcut": "MTL",
            "logo": "MTL.png",
            "conference": "E",
            "division": "A",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Nashville Predators",
            "shortcut": "NSH",
            "logo": "NSH.png",
            "conference": "W",
            "division": "C",
            "points": 0,
            "clinched": false
        },
        {
            "name": "New Jersey Devils",
            "shortcut": "NJD",
            "logo": "NJD.png",
            "conference": "E",
            "division": "M",
            "points": 0,
            "clinched": false
        },
        {
            "name": "New York Islanders",
            "shortcut": "NYI",
            "logo": "NYI.png",
            "conference": "E",
            "division": "M",
            "points": 0,
            "clinched": false
        },
        {
            "name": "New York Rangers",
            "shortcut": "NYR",
            "logo": "NYR.png",
            "conference": "E",
            "division": "M",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Ottawa Senators",
            "shortcut": "OTT",
            "logo": "OTT.png",
            "conference": "E",
            "division": "A",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Philadelphia Flyers",
            "shortcut": "PHI",
            "logo": "PHI.png",
            "conference": "E",
            "division": "M",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Pittsburgh Penguins",
            "shortcut": "PIT",
            "logo": "PIT.png",
            "conference": "E",
            "division": "M",
            "points": 0,
            "clinched": false
        },
        {
            "name": "San Jose Sharks",
            "shortcut": "SJS",
            "logo": "SJS.png",
            "conference": "W",
            "division": "P",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Seattle Kraken",
            "shortcut": "SEA",
            "logo": "SEA.png",
            "conference": "W",
            "division": "P",
            "points": 0,
            "clinched": false
        },
        {
            "name": "St. Louis Blues",
            "shortcut": "STL",
            "logo": "STL.png",
            "conference": "W",
            "division": "C",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Tampa Bay Lightning",
            "shortcut": "TBL",
            "logo": "TBL.png",
            "conference": "E",
            "division": "A",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Toronto Maple Leafs",
            "shortcut": "TOR",
            "logo": "TOR.png",
            "conference": "E",
            "division": "A",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Vancouver Canucks",
            "shortcut": "VAN",
            "logo": "VAN.png",
            "conference": "W",
            "division": "P",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Vegas Golden Knights",
            "shortcut": "VGK",
            "logo": "VGK.png",
            "conference": "W",
            "division": "P",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Washington Capitals",
            "shortcut": "WSH",
            "logo": "WSH.png",
            "conference": "E",
            "division": "M",
            "points": 0,
            "clinched": false
        },
        {
            "name": "Winnipeg Jets",
            "shortcut": "WPG",
            "logo": "WPG.png",
            "conference": "W",
            "division": "C",
            "points": 0,
            "clinched": false
        }
    ],
    mounted() {
        this.generateStandings()
    },
    standings: [
        {
            conference: {
                name: "West Conference",
                shortcut: "W"
            },
            division: [
                {
                    name: "Central Division",
                    short: "C",
                    standings: []
                },
                {
                    name: "Pacific Division",
                    short: "P",
                    standings: []
                }
            ],
            wildCard: {
                name: "Wild Card",
                shortcut: "WC",
                standings: []
            }
        },
        {
            conference: {
                name: "West Conference",
                shortcut: "W"
            },
            division: [
                {
                    name: "Metropolitan Division",
                    short: "M",
                    standings: [],
                },
                {
                    name: "Atlantic Division",
                    short: "A",
                    standings: [],
                }
            ],
            wildCard: {
                name: "Wild Card",
                shortcut: "WC",
                standings: []
            }
        }
    ],
    generateStandings() {
        this.generatePoints()
        
        const divisions = ['A', 'M', 'C', 'P'];
        const eastDivisions = ['A', 'M'];
        const westDivisions = ['C', 'P'];
    
        // Vyčisti standings
        this.standings = [
            {
                conference: { name: "Western Conference", shortcut: "W" },
                division: [
                    { name: "Central Division", short: "C", standings: [] },
                    { name: "Pacific Division", short: "P", standings: [] }
                ],
                wildCard: {
                    name: "Wild Card",
                    shortcut: "WC",
                    standings: []
                }
            },
            {
                conference: { name: "Eastern Conference", shortcut: "E" },
                division: [
                    { name: "Metropolitan Division", short: "M", standings: [] },
                    { name: "Atlantic Division", short: "A", standings: [] }
                ],
                wildCard: {
                    name: "Wild Card",
                    shortcut: "WC",
                    standings: []
                }
            }
        ];
    
        // Zoskupiť tímy podľa divízií a zoradiť podľa bodov
        const grouped = { A: [], M: [], C: [], P: [] };
        this.teams.forEach(team => {
            if (grouped[team.division]) grouped[team.division].push(team);
        });
        divisions.forEach(div => {
            grouped[div].sort((a, b) => b.points - a.points);
        });
    
        const wildcards = { E: [], W: [] };
    
        // Pridanie top 3 tímov z každej divízie a zvyšné idú do wild card poolu
        for (const div of divisions) {
            const topThree = grouped[div].slice(0, 3);
            const rest = grouped[div].slice(3);
            const conf = eastDivisions.includes(div) ? 'E' : 'W';
    
            const confIndex = conf === 'E' ? 1 : 0;
            const divIndex = this.standings[confIndex].division.findIndex(d => d.short === div);
            this.standings[confIndex].division[divIndex].standings = topThree;
            wildcards[conf].push(...rest);
        }
    
        // Zoradiť wild card tímy a pridať najlepšie 2 do standings
        ['E', 'W'].forEach(conf => {
            wildcards[conf].sort((a, b) => b.points - a.points);
            const confIndex = conf === 'E' ? 1 : 0;
            this.standings[confIndex].wildCard.standings = wildcards[conf];
        })
    },    
    randomNum(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min
    },
    generatePoints() {
        this.teams.map(team => {
            team.points = this.randomNum(50, 120)
        })
    }
}).mount("#nhl-standings-generator")